---
globs: apps/api/**/*.ts,apps/api/**/*.js
description: Regras para desenvolvimento do backend NestJS
---

# Backend NestJS - TCC-Estufa

Utiliza em desenvolvimento a porta 5000

## Estrutura de MÃ³dulos

O backend estÃ¡ organizado em mÃ³dulos principais:

### ğŸ—ï¸ MÃ³dulos Principais

- **auth/** - AutenticaÃ§Ã£o e autorizaÃ§Ã£o
- **greenhouse/** - GestÃ£o de estufas
- **sensor/** - Coleta e processamento de dados dos sensores
- **irrigation/** - Controle de irrigaÃ§Ã£o
- **pump/** - GestÃ£o de bombas
- **plant/** - GestÃ£o de plantas
- **user/** - GestÃ£o de usuÃ¡rios
- **blog/** - Sistema de blog
- **websocket/** - ComunicaÃ§Ã£o em tempo real

### ğŸ—„ï¸ Banco de Dados

- **Prisma ORM** com PostgreSQL
- Schema principal: [apps/api/prisma/schema.prisma](mdc:apps/api/prisma/schema.prisma)
- MigraÃ§Ãµes: [apps/api/prisma/migrations/](mdc:apps/api/prisma/migrations/)

### ğŸ”§ PadrÃµes de Desenvolvimento

- Use DTOs para validaÃ§Ã£o de entrada
- Implemente guards para autenticaÃ§Ã£o/autorizaÃ§Ã£o
- Use decorators do Swagger para documentaÃ§Ã£o da API
- Mantenha logs estruturados com Winston
- Use WebSockets para comunicaÃ§Ã£o em tempo real

### ğŸ“ Exemplo de Estrutura de MÃ³dulo

```typescript
@Module({
  imports: [PrismaModule],
  controllers: [FeatureController],
  providers: [FeatureService],
  exports: [FeatureService],
})
export class FeatureModule {}
```

### ğŸ§ª Testes

- Scripts de teste: `npm run test:irrigation`, `npm run test:frontend-notifications`
- Testes E2E configurados em [apps/api/test/](mdc:apps/api/test/)

---
globs: apps/esp/**/*.cpp,apps/esp/**/*.h,apps/esp/**/*.ino
description: Regras para desenvolvimento do firmware ESP32
---

# Firmware ESP32 - TCC-Estufa

## Estrutura do Hardware

### ğŸ”Œ Sensores Implementados

- **TH_SENSOR** - Temperatura e Umidade ambiente (DHT22)
- **SOIL_SENSOR** - Umidade do solo
- **FLOW_SENSOR** - Sensor de vazÃ£o para irrigaÃ§Ã£o
- **OLED** - Display para informaÃ§Ãµes locais

### ğŸ›ï¸ Atuadores

- **PUMP** - Bomba de irrigaÃ§Ã£o
- **QR_CONFIG** - ConfiguraÃ§Ã£o via QR Code

### ğŸ“¡ ComunicaÃ§Ã£o

- **SERVER** - ComunicaÃ§Ã£o HTTP com a API
- **Wi-Fi** - ConexÃ£o de rede

## Estrutura de CÃ³digo

### ğŸ“ OrganizaÃ§Ã£o

- **src/main.cpp** - Arquivo principal
- **lib/** - Bibliotecas customizadas para cada componente
- **include/** - Headers compartilhados
- **platformio.ini** - ConfiguraÃ§Ã£o do PlatformIO

### ğŸ”§ PadrÃµes de Desenvolvimento

- Use PlatformIO para desenvolvimento
- Mantenha bibliotecas separadas por funcionalidade
- Implemente tratamento de erro robusto
- Use configuraÃ§Ã£o via QR Code para facilitar setup
- Mantenha logs detalhados para debugging

### ğŸŒ ComunicaÃ§Ã£o com API

- Envio de dados dos sensores via HTTP POST
- Recebimento de comandos de controle
- ImplementaÃ§Ã£o de heartbeat para status
- ReconexÃ£o automÃ¡tica em caso de falha

### ğŸ§ª Testes

- Guia de teste da bomba: [apps/esp/pump-test-guide.md](mdc:apps/esp/pump-test-guide.md)
- Script de teste Python: [apps/esp/test_pump.py](mdc:apps/esp/test_pump.py)

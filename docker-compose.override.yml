# ==========================================================
# Docker Compose Override for Local Development
# ==========================================================
# This file extends docker-compose.yml with local settings
#
# Usage:
# 1. Copy this file or modify directly
# 2. Set your ESP32 IP and Greenhouse ID
# 3. Run: docker-compose up
#
# For auto-start monitoring:
#   docker-compose up -d
#   (The AI service will auto-connect to ESP32 and start irrigation)

version: "3.8"

services:
  ai:
    # Use host network to reach ESP32 on local network
    network_mode: host
    environment:
      # ⚠️ CONFIGURE THESE FOR YOUR SETUP ⚠️
      - ESP32_IP=192.168.0.87
      - ESP32_PORT=8080
      - GREENHOUSE_ID=f9f09e4e-f18a-40f0-939d-d682edf6af5e

      # Plant configuration (AI uses ideal moisture if TARGET_MOISTURE not set)
      - PLANT_TYPE=default
      # - TARGET_MOISTURE=60  # Uncomment to override AI decision

      # Irrigation parameters
      - PULSE_DURATION=0.5
      - PULSE_WAIT=60

      # Auto-start monitoring on container startup
      - AUTO_START_MONITOR=true

      # Backend URL (use host network address)
      - BACKEND_URL=http://127.0.0.1:5000

    # Mount models for persistence
    volumes:
      - ./apps/ai/models/saved:/app/models/saved:ro
